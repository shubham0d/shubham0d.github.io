<!DOCTYPE html>
<html>
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Finding and removing malware from windows in minimal steps using sysinternals suite</title>
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" type="text/css" href="../assets/built/screen.css?v=8851e814ec">

    <meta name="description" content="Did your system ever get affected with malwares? Did you know you can manually remove common malwares with very little technical knowledge">
    <link rel="shortcut icon" href="../favicon.png" type="image/png">
    <link rel="canonical" href="index.html">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="amphtml" href="amp/index.html">
    
    <meta property="og:site_name" content="Linuxed and reversed ">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Finding and removing malware from windows in minimal steps using sysinternals suite">
    <meta property="og:description" content="Did your system ever get affected with malwares? Did you know you can manually remove common malwares with very little technical knowledge.
In this article I will explain you how to find malware using sysinternals suite.">
    <meta property="og:url" content="https://shubham0d.github.io/finding-and-removing-malware-from-windows-in-minimal-steps-using-sysinternals-suite/">
    <meta property="og:image" content="https://shubham0d.github.io/content/images/2017/12/check-malware-script-installed-blog-FILEminimizer1.jpg">
    <meta property="article:published_time" content="2017-12-31T14:20:02.000Z">
    <meta property="article:modified_time" content="2017-12-31T18:56:42.000Z">
    <meta property="article:tag" content="Security">
    <meta property="article:tag" content="Analysis">
    <meta property="article:tag" content="Tutorial">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Finding and removing malware from windows in minimal steps using sysinternals suite">
    <meta name="twitter:description" content="Did your system ever get affected with malwares? Did you know you can manually remove common malwares with very little technical knowledge.
In this article I will explain you how to find malware using sysinternals suite.">
    <meta name="twitter:url" content="https://shubham0d.github.io/finding-and-removing-malware-from-windows-in-minimal-steps-using-sysinternals-suite/">
    <meta name="twitter:image" content="https://shubham0d.github.io/content/images/2017/12/check-malware-script-installed-blog-FILEminimizer1.jpg">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Shubham Dubey">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="Security, Analysis, Tutorial">
    <meta property="og:image:width" content="765">
    <meta property="og:image:height" content="480">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Linuxed and reversed ",
        "logo": "https://shubham0d.github.io/content/images/2017/12/2000px-Free_Software_and_Open_Source_Software_Composite_Logo.svg-1.png"
    },
    "author": {
        "@type": "Person",
        "name": "Shubham Dubey",
        "image": {
            "@type": "ImageObject",
            "url": "https://shubham0d.github.io/content/images/2017/12/IMG_20170218_212118.jpg",
            "width": 1080,
            "height": 1920
        },
        "url": "https://shubham0d.github.io/author/shubham0d/",
        "sameAs": []
    },
    "headline": "Finding and removing malware from windows in minimal steps using sysinternals suite",
    "url": "https://shubham0d.github.io/finding-and-removing-malware-from-windows-in-minimal-steps-using-sysinternals-suite/",
    "datePublished": "2017-12-31T14:20:02.000Z",
    "dateModified": "2017-12-31T18:56:42.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://shubham0d.github.io/content/images/2017/12/check-malware-script-installed-blog-FILEminimizer1.jpg",
        "width": 765,
        "height": 480
    },
    "keywords": "Security, Analysis, Tutorial",
    "description": "Did your system ever get affected with malwares? Did you know you can manually remove common malwares with very little technical knowledge.\nIn this article I will explain you how to find malware using sysinternals suite.",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://shubham0d.github.io/"
    }
}
    </script>

    <script type="text/javascript" src="../public/ghost-sdk.min.js?v=8851e814ec"></script>
<script type="text/javascript">
ghost.init({
	clientId: "ghost-frontend",
	clientSecret: "90051550b0c1"
});
</script>
    <meta name="generator" content="Ghost 1.19">
    <link rel="alternate" type="application/rss+xml" title="Linuxed and reversed " href="../rss/index.rss">

</head>
<body class="post-template tag-security tag-analysis tag-tutorial">

    <div class="site-wrapper">

        

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
                <a class="site-nav-logo" href="../index.html"><img src="../content/images/2017/12/2000px-Free_Software_and_Open_Source_Software_Composite_Logo.svg-1.png" alt="Linuxed and reversed "></a>
            <ul class="nav" role="menu">
    <li class="nav-home" role="menuitem"><a href="../index.html">Home</a></li>
</ul>

    </div>
    <div class="site-nav-right">
        <div class="social-links">
        </div>
            <a class="subscribe-button" href="index.html#subscribe">Subscribe</a>
    </div>
</nav>
    </div>
</header>


<main id="site-main" class="site-main outer" role="main">
    <div class="inner">

        <article class="post-full post tag-security tag-analysis tag-tutorial featured ">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime="2017-12-31">31 December 2017</time>
                        <span class="date-divider">/</span> <a href="../tag/security/index.html">Security</a>
                </section>
                <h1 class="post-full-title">Finding and removing malware from windows in minimal steps using sysinternals suite</h1>
            </header>

            <figure class="post-full-image" style="background-image: url(../content/images/2017/12/check-malware-script-installed-blog-FILEminimizer1.jpg)">
            </figure>

            <section class="post-full-content">
                <div class="kg-card-markdown"><p>Hello, there!<br>
<em>Did your system ever get affected with malwares?</em><br>
Probably yes!, maybe that’s why you are reading this article. And If your answer is no! Then maybe you never tried to find answers for questions like <em>whats wrong with your system?, why it is behaving different? and why  is it slow from few days?</em>. But you may argue that you never face these issues because you always use antivirus software.<br>
Well, you are partially right there. Antivirus can save you from malwares most of the time(atleast from those malwares from which most users get affected) but not always. And what if you don’t have any antivirus installed. Did you ever think that you can also manually remove common malwares with very little technical knowledge.</p>
<p>You must have guessed that I am gonna teach you that in this post. Yes! but in some extent. <em><strong>This post is more about my recent experience with malware’s on my friends computer and how did I removed them</strong>.</em> But don’t close this tab after reading this because you can use the same procedure to detect the most malwares affecting your system. Also in future articles I will explain the In-depth procedure for malware detection that you can use. But for now lets look at minimal things that you can do.</p>
<h2 id="herestartsthestory">Here starts the story</h2>
<p>Recently one of my friend complained me about his windows 8 working slow, power consumption get high from few days. Also the major issue he was facing is whenever he try to browse any site in mozilla firefox he gets error about invalid certificate and connection is not secure.</p>
<p><img src="../content/images/2017/12/invalidcertificaate.png" alt="invalidcertificaate"></p>
<p>By looking at these issues I knew that something must be fishy going on in his system but I got no idea what may have causing these issues. It maybe some program that he have installed causing that or maybe some misconfiguration.</p>
<p>So, my first priroty is to fix the browser issue. Other issues are something that windows users always complain about, so I try to ignore them.<br>
I have the seen the browser issue multiple times so I was sure it must be causing due to change in proxy setting by some program(to monitor the traffic) or because of antivirus itself. So, first thing I tried is looking for current proxy setting in firefox. For that I click on right top icon on firefox and then on options from the drop down.</p>
<p><img src="../content/images/2017/12/imageedit_2_5575992658.png" alt="imageedit_2_5575992658"></p>
<p>In General tab at the bottom I found network proxy option.</p>
<p><img src="../content/images/2017/12/proxyfirefox.png" alt="proxyfirefox"></p>
<p>I was expecting it to set to some Manual proxy configuration but it is set correctly to auto detect proxy settings.</p>
<p><img src="../content/images/2017/12/updatedproxyimage.png" alt="updatedproxyimage"><br>
Next step I did is to look for antivirus in his system which generally change the proxy settings. But my friend told he doesn’t have any antivirus program installed on his system(which I think maybe the root cause of problem.). So, I look for some installed program in hope that I will find some malicious program and will uninstall that. But there was nothing installed that I can tell is fishy.<br>
So, after little more struggle I decide to use sysinternals suite to look deeper into the problem.</p>
<h2 id="whataresysinternalssuite">What are sysinternals suite?</h2>
<p>Sysinternals suite(<a href="https://docs.microsoft.com/en-us/sysinternals/downloads/sysinternals-suite">link</a>) consist of utilities/tools to help you manage, troubleshoot and diagnose your Windows systems and applications. Some most common tools are process explorer, registry editor etc.</p>
<p>Now, first step I have done after downloading the tools is extracting the zip and starting the process explorer(inside the folder procexp). It show me all the running processes in the system.</p>
<p><img src="../content/images/2017/12/imageedit_4_4535969268.png" alt="imageedit_4_4535969268"></p>
<p>I click on options on the top bar and check the Verify image signature entry so that I can neglect the windows verified(code-signed) programs and only concentrate on not verified programs.<br>
Well, I have found two interesting non verified services running in the system.<br>
One is <em>isMiner</em> program running and using lots of cpu(You must have guessed its working just by looking at its name).<br>
Other is some random named program “<em>2e4e333….</em>" (which looks like some hash value). It also got a little suspicious icon which takes my attention.<br>
Before going further on any discussion I must need to know for sure that these are the program causing trouble. One thing I am sure about is if they are any type of malware then they must try to persist themselves in the system. For that windows applications add autorun entries key on the registry. So I started the Autoruns tool present in sysinternals toolset. Then I try to find out the entries for both of these programs and successfully found that somewhere down.<br>
There is a tick box before their names, showing if these autorun is enabled or not. So, I disable both of them.</p>
<p><img src="../content/images/2017/12/image1.PNG" alt="image1"><br>
<img src="../content/images/2017/12/image2.PNG" alt="image2"></p>
<blockquote>
<p><em><strong>Note</strong></em>: I can also delete these entries by right click→ select Delete, but it is recommended that you just turn off these autoruns because the program running for these entries maybe get triggered when those registry keys are deleted and it add them back again.<em>Hope that make sense!</em></p>
</blockquote>
<p>You can easily argue for now that these program maybe some legitimate programs used by some other process. So, I finally need to confirm that these are the malwares running there.<br>
For that I right click on both entries and select ‘<em>jump to image</em>’. It takes me to the location of executable saved for these programs. One of them is at User→ AppData→ Roaming (which is a common place malware put their executable for autorun on system startup)</p>
<p><img src="../content/images/2017/12/image3.PNG" alt="image3"><br>
other was inside C:\→ Program files.</p>
<p>I copy all the executables and place them inside some known location. Next step is to check if these program are really dangerous or not. For that I went to a website called virustotal.com. VirusTotal(owned by google)  analyze suspicious files and URLs to detect types of malware including viruses, worms, and trojans.<br>
First I uploaded isMiner.exe.</p>
<p><img src="../content/images/2017/12/virustotal1.png" alt="virustotal1"></p>
<p>You can see that it is detected by <em>44/65</em> antivirus programs. You can easy guess that it is a Bitcoin miner program that uses your cpu power to mine bitcoins. It is also the cause of high power consumption by your system and even slow performance sometimes.</p>
<p><img src="../content/images/2017/12/isminer2.png" alt="isminer2"></p>
<p>There is another file named <em>xmrig.exe</em> there which is the file generated by <em>isMiner.exe</em> for its working.<br>
Analyzing that shows detection ratio <em>47/67</em>.<br>
Now lets upload the another suspicious program.</p>
<p><img src="../content/images/2017/12/exe2.png" alt="exe2"></p>
<p>Well, it got detected by 13 /67 antiviruses means it is quite good at hiding itself.<br>
With a little static analysis I was able to find out that it is a adware(also can be confirm using virustotal report). Then I run it inside a sandboxed environment and found that it show large ads banner on every browser’s page. So, the firefox error about not secure connection is causing by this program only since it monitor all the pages you browse and shows ads on them.</p>
<p>So It was confirmed that both of these program are the malwares affecting the system. I delete both of them(registry keys are already disabled) and restarted the system. And as you can imagine after next reboot all those issues are gone and the system became normal again.</p>
<p>So, thats it for this post. In future article I will show you how I reverse engineer these malware and we also look into how to use other utility in sysinternals suite to find malwares.<em><strong>Stay tuned!</strong></em></p>
</div>
            </section>

            <section class="subscribe-form">
                <h3 class="subscribe-form-title">Subscribe to Linuxed and reversed </h3>
                <p>Get the latest posts delivered right to your inbox</p>
                <form method="post" action="https://shubham0d.github.io/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"><input class="location" type="hidden" name="location"><input class="referrer" type="hidden" name="referrer">

    <div class="form-group">
        <input class="subscribe-email" type="email" name="email" placeholder="youremail@example.com">
    </div>
    <button class="" type="submit"><span>Subscribe</span></button>
    <script type="text/javascript">(function(g,h,o,s,t){h[o]('.location')[s]=h[o]('.location')[s] || g.location.href;h[o]('.referrer')[s]=h[o]('.referrer')[s] || h.referrer;})(window,document,'querySelector','value');</script>
</form>


            </section>

            <footer class="post-full-footer">

                <section class="author-card">
                        <img class="author-profile-image" src="../content/images/2017/12/IMG_20170218_212118.jpg" alt="Shubham Dubey">
                    <section class="author-card-content">
                        <h4 class="author-card-name"><a href="../author/shubham0d/index.html">Shubham Dubey</a></h4>
                            <p>Read <a href="../author/shubham0d/index.html">more posts</a> by this author.</p>
                    </section>
                </section>
                <div class="post-full-footer-right">
                    <a class="author-card-button" href="../author/shubham0d/index.html">Read More</a>
                </div>

            </footer>




            <section class="post-full-comments">
                <div id="disqus_thread"></div>
                <script>
                    var disqus_config = function () {
                        this.page.url = 'https://shubham0d.github.io/finding-and-removing-malware-from-windows-in-minimal-steps-using-sysinternals-suite/';
                        this.page.identifier = 'ghost-5a48ea60ac4a8a1324eb0c45';
                    };
                    (function() {
                        var d = document, s = d.createElement('script');
                        s.src = 'https://shubham0d.disqus.com/embed.js';
                        s.setAttribute('data-timestamp', +new Date());
                        (d.head || d.body).appendChild(s);
                    })();
                </script>
            </section>


        </article>

    </div>
</main>

<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
                <article class="read-next-card" style="background-image: url(../content/images/2017/12/410329-636167162756711825-16x9.jpg)">
                    <header class="read-next-card-header">
                        <small class="read-next-card-header-sitetitle">— Linuxed and reversed  —</small>
                        <h3 class="read-next-card-header-title"><a href="../tag/security/index.html">Security</a></h3>
                    </header>
                    <div class="read-next-divider"><svg xmlns="//www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"></path></svg>
</div>
                    <div class="read-next-card-content">
                        <ul>
                            <li><a href="../sandboxing-and-program-isolation-in-linux-using-many-approaches-part-2/index.html">Sandboxing and program isolation in linux using many approaches (Part 2)</a></li>
                            <li><a href="../sandboxing-and-program-isolation-in-linux-using-many-approaches/index.html">Sandboxing and program isolation in linux using many approaches (Part 1)</a></li>
                        </ul>
                    </div>
                    <footer class="read-next-card-footer">
                        <a href="../tag/security/index.html">See all 2 posts →</a>
                    </footer>
                </article>


                <article class="post-card post tag-security tag-virtualization tag-linux tag-containers">
        <a class="post-card-image-link" href="../sandboxing-and-program-isolation-in-linux-using-many-approaches-part-2/index.html">
            <div class="post-card-image" style="background-image: url(../content/images/2017/12/SandBox-1.jpg)"></div>
        </a>
    <div class="post-card-content">
        <a class="post-card-content-link" href="../sandboxing-and-program-isolation-in-linux-using-many-approaches-part-2/index.html">
            <header class="post-card-header">
                    <span class="post-card-tags">Security</span>
                <h2 class="post-card-title">Sandboxing and program isolation in linux using many approaches (Part 2)</h2>
            </header>
            <section class="post-card-excerpt">
                <p>Containers  are tools for isolation which use namespaces to archive that.They are called light weight virtualization because they provide process level isolation only, means they depend on linux kernel.</p>
            </section>
        </a>
        <footer class="post-card-meta">
                <img class="author-profile-image" src="../content/images/2017/12/IMG_20170218_212118.jpg" alt="Shubham Dubey">
            <span class="post-card-author"><a href="../author/shubham0d/index.html">Shubham Dubey</a></span>
        </footer>
    </div>
</article>

        </div>
    </div>
</aside>

<div class="floating-header">
    <div class="floating-header-logo">
        <a href="../index.html">
                <img src="../content/images/2017/12/rock_tux.png" alt="Linuxed and reversed  icon">
            <span>Linuxed and reversed </span>
        </a>
    </div>
    <span class="floating-header-divider">—</span>
    <div class="floating-header-title">Finding and removing malware from windows in minimal steps using sysinternals suite</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="//www.w3.org/2000/svg" viewbox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"></path>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=Finding%20and%20removing%20malware%20from%20windows%20in%20minimal%20steps%20using%20sysinternals%20suite&amp;url=https://shubham0d.github.io/finding-and-removing-malware-from-windows-in-minimal-steps-using-sysinternals-suite/" onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="//www.w3.org/2000/svg" viewbox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"></path></svg>
        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=https://shubham0d.github.io/finding-and-removing-malware-from-windows-in-minimal-steps-using-sysinternals-suite/" onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="//www.w3.org/2000/svg" viewbox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"></path></svg>
        </a>
    </div>
    <progress class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>


<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>





        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="../index.html">Linuxed and reversed </a> © 2018</section>
                <nav class="site-footer-nav">
                    <a href="../index.html">Latest Posts</a>
                    
                    
                    <a href="https://ghost.org" target="_blank" rel="noopener">Ghost</a>
                </nav>
            </div>
        </footer>

    </div>

    <div id="subscribe" class="subscribe-overlay">
        <a class="subscribe-overlay-close" href="index.html#"></a>
        <div class="subscribe-overlay-content">
                <img class="subscribe-overlay-logo" src="../content/images/2017/12/2000px-Free_Software_and_Open_Source_Software_Composite_Logo.svg-1.png" alt="Linuxed and reversed ">
            <h1 class="subscribe-overlay-title">Subscribe to Linuxed and reversed </h1>
            <p class="subscribe-overlay-description">Stay up to date! Get all the latest &amp; greatest posts delivered straight to your inbox</p>
            <form method="post" action="https://shubham0d.github.io/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"><input class="location" type="hidden" name="location"><input class="referrer" type="hidden" name="referrer">

    <div class="form-group">
        <input class="subscribe-email" type="email" name="email" placeholder="youremail@example.com">
    </div>
    <button class="" type="submit"><span>Subscribe</span></button>
    <script type="text/javascript">(function(g,h,o,s,t){h[o]('.location')[s]=h[o]('.location')[s] || g.location.href;h[o]('.referrer')[s]=h[o]('.referrer')[s] || h.referrer;})(window,document,'querySelector','value');</script>
</form>


        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="../assets/js/jquery.fitvids.js?v=8851e814ec"></script>


    <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();
});
</script>


    

</body>
</html>